{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/request-response-javascript/","result":{"data":{"site":{"siteMetadata":{"title":"Sabrina S. Santos","author":"johnywalves","siteUrl":"https://SabrinaSS.com"}},"markdownRemark":{"frontmatter":{"date":"15 de maio de 2019","created":"2019-05-15 10:13:13 -0300","title":"Comunicação HTTP Servidor e Client","description":"Iniciando com Node Express","category":"JavaScript","tags":["Web","Server","Client","Request","Response","Tutorial"],"extras":null,"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAME/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAHXIzSA/wD/xAAZEAADAAMAAAAAAAAAAAAAAAAAAQISEyL/2gAIAQEAAQUCzW2qRyf/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwEn/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8BZ//EABkQAQEAAwEAAAAAAAAAAAAAAAEAITNBov/aAAgBAQAGPwJOllG1+b//xAAYEAEAAwEAAAAAAAAAAAAAAAABABGRQf/aAAgBAQABPyFoygQRsFxtxqf/2gAMAwEAAgADAAAAEI/v/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAEhUf/aAAgBAwEBPxCETD//xAAXEQADAQAAAAAAAAAAAAAAAAAAARFR/9oACAECAQE/EEpHrP/EABoQAQEAAwEBAAAAAAAAAAAAAAERACFRQbH/2gAIAQEAAT8QkIERGOtPPcqzrICXkTeKDCl2HzP/2Q=="},"images":{"fallback":{"src":"/static/f80ea715386c4e3e7ae9bb08e5b6931b/c62f0/mail-1.jpg","srcSet":"/static/f80ea715386c4e3e7ae9bb08e5b6931b/86eb0/mail-1.jpg 300w,\n/static/f80ea715386c4e3e7ae9bb08e5b6931b/a06fe/mail-1.jpg 600w,\n/static/f80ea715386c4e3e7ae9bb08e5b6931b/c62f0/mail-1.jpg 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/f80ea715386c4e3e7ae9bb08e5b6931b/cf267/mail-1.webp 300w,\n/static/f80ea715386c4e3e7ae9bb08e5b6931b/540ab/mail-1.webp 600w,\n/static/f80ea715386c4e3e7ae9bb08e5b6931b/3d0d9/mail-1.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":500}}}},"html":"<p>Usar a mesma linguagem na ponta-a-ponta em um ambiente favorece a troca de conhecimento entre equipes e atualmente JavaScript é uma ótima opção, pois tem suporte nativo nos navegadores e facilidade desenvolvimento com o Node</p>\n<h2>Servidor (Resposta)</h2>\n<p>Usando o Express vamos começar importando as bibliotecas para o servidor com o <strong>npm</strong></p>\n<ul>\n<li>Express: Controle de fluxo das requisições e respostas</li>\n<li>Body-Parser: intepretar conteúdo das requisições</li>\n<li>Cors: adicionar no protocolo Http os elementos necessários para comunicação <a href=\"https://pt.wikipedia.org/wiki/Cross-origin_resource_sharing\">CORS</a></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> i express body-parser cors</code></pre></div>\n<p>Gerando o arquivo com <strong>server.js</strong> com o conteúdo abaixo, com os detalhes no comentário</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Importação de bibliotecas</span>\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> bodyParser <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"body-parser\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> cors <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cors\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Ferramenta para controlar a requisição e resposta</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Possibilidade fazer requisições pelo navegador</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token function\">cors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// leitura e escrita para arquivos JSON</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>bodyParser<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Criação do endpoint /mirror que retorna o json da requisição</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/mirror\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span>req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Definição de porta que será ouvida, ex: 8080</span>\n<span class=\"token keyword\">const</span> port <span class=\"token operator\">=</span> <span class=\"token number\">8080</span>\n\n<span class=\"token comment\">// Iniciar o servidor e ouvir a porta</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Escutando a porta \"</span> <span class=\"token operator\">+</span> port <span class=\"token operator\">+</span> <span class=\"token string\">\"!\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Para executar simplemente podemos usar o <code class=\"language-text\">node</code> informando o arquivo desejado</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">node</span> server.js</code></pre></div>\n<h2>Client fetch (Requisição por fetch)</h2>\n<p>Usando a biblioteca do <strong>fetch</strong> nativa do JavaScript</p>\n<h3>Configuração de Requisição</h3>\n<p>Primeiro precisamos criar a configuração que será usada</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"Content-Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Vida, Universo e Tudo mais\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Requisição pelo navegador</h3>\n<p>O operador <code class=\"language-text\">await</code> é utilizado para esperar por uma Promise. Ele deve ser usado apenas dentro de uma função assíncrona com <code class=\"language-text\">async function</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://localhost:8080/mirror\"</span><span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Ou com o usado no <code class=\"language-text\">then</code> e <code class=\"language-text\">catch</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://localhost:8080/mirror\"</span><span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>status <span class=\"token operator\">===</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">content</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Lidar com os dados recebidos</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'content'</span><span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Tratar exceções: erros e outras situações</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Requisição pelo Node</h3>\n<p>Instalar a biblioteca de fetch para o Node</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> i node-fetch</code></pre></div>\n<p>Gerando o arquivo com <strong>client.js</strong>, com a importação da biblioteca para uso</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Importação da biblioteca de fetch</span>\n<span class=\"token keyword\">const</span> fetch <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"node-fetch\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Execução do comando</span>\n<span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://localhost:8080/mirror\"</span><span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">json</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Executar pelo Node com o comando</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">node</span> client.js</code></pre></div>","timeToRead":2,"excerpt":"Usar a mesma linguagem na ponta-a-ponta em um ambiente favorece a troca de conhecimento entre equipes e atualmente JavaScript é uma ótima…"}},"pageContext":{"slug":"/request-response-javascript/","recommendedLast":{"frontmatter":{"date":"23 de julho de 2023","title":"Animação para esqueleto de elementos","category":"CSS","description":"Usando HTML, CSS e keyframes para animação de esqueleto de elementos carregando com gradiente","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBP/EABYBAQEBAAAAAAAAAAAAAAAAAAECBP/aAAwDAQACEAMQAAABzSNNUhf/xAAXEAADAQAAAAAAAAAAAAAAAAABAiEy/9oACAEBAAEFAoEhd9f/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAARARQf/aAAgBAQAGPwK9E4//xAAZEAACAwEAAAAAAAAAAAAAAAAAAREhMVH/2gAIAQEAAT8hqw0N8FBZj//aAAwDAQACAAMAAAAQf+//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8QxH//xAAbEAEAAwEAAwAAAAAAAAAAAAABESFBADFhgf/aAAgBAQABPxAAUttKr5ykW1HIJTkPIifJvvv/2Q=="},"images":{"fallback":{"src":"/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/c62f0/skeleton-1.jpg","srcSet":"/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/86eb0/skeleton-1.jpg 300w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/a06fe/skeleton-1.jpg 600w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/c62f0/skeleton-1.jpg 1200w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/23bd6/skeleton-1.jpg 2400w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/cf267/skeleton-1.webp 300w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/540ab/skeleton-1.webp 600w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/3d0d9/skeleton-1.webp 1200w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/51c0c/skeleton-1.webp 2400w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":500}}},"published":true},"timeToRead":1,"fields":{"slug":"/estilizacao-skeleton/"}},"recommendedCategory":{"frontmatter":{"date":"28 de março de 2023","title":"Automação de screenshot com Puppeteer","category":"JavaScript","description":"Armazenar telas de páginas Web com Puppeteer, JavaScript e NodeJS","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAEDBP/EABYBAQEBAAAAAAAAAAAAAAAAAAIAAf/aAAwDAQACEAMQAAABxSW0Av8A/8QAGBABAQADAAAAAAAAAAAAAAAAAgABESH/2gAIAQEAAQUCA6jhWr//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwGq/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8BiP/EABkQAAEFAAAAAAAAAAAAAAAAAAAQISIxkf/aAAgBAQAGPwJ6IYn/xAAYEAEBAQEBAAAAAAAAAAAAAAABIQARMf/aAAgBAQABPyGZONkkvjKHib//2gAMAwEAAgADAAAAEHwP/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERIf/aAAgBAwEBPxBvaLB//8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EA5kgb//xAAXEAEBAQEAAAAAAAAAAAAAAAABEQAh/9oACAEBAAE/EFhxCRRbOczWGpREF5r4Xf/Z"},"images":{"fallback":{"src":"/static/66aea979cc4b530d5d322c1f1095666a/c62f0/robot-1.jpg","srcSet":"/static/66aea979cc4b530d5d322c1f1095666a/86eb0/robot-1.jpg 300w,\n/static/66aea979cc4b530d5d322c1f1095666a/a06fe/robot-1.jpg 600w,\n/static/66aea979cc4b530d5d322c1f1095666a/c62f0/robot-1.jpg 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/66aea979cc4b530d5d322c1f1095666a/cf267/robot-1.webp 300w,\n/static/66aea979cc4b530d5d322c1f1095666a/540ab/robot-1.webp 600w,\n/static/66aea979cc4b530d5d322c1f1095666a/3d0d9/robot-1.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":500}}},"published":true},"timeToRead":2,"fields":{"slug":"/puppeteer-screenshot/"}}}},"staticQueryHashes":["1433154849","3590877595","3764592887","512065377","764694655"],"slicesMap":{}}