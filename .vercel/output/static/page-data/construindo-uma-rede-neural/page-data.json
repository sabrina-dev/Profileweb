{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/construindo-uma-rede-neural/","result":{"data":{"site":{"siteMetadata":{"title":"Sabrina S. Santos","author":"johnywalves","siteUrl":"https://SabrinaSS.com"}},"markdownRemark":{"frontmatter":{"date":"22 de março de 2023","created":"2023-03-22 11:58:13 -0300","title":"Construindo uma rede neural","description":"Criação de uma estrutura de rede neural do zero com Python","category":"Python","tags":["Rede Neural","Aprendizado de máquina","Machine Learning"],"extras":null,"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMC/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQMF/9oADAMBAAIQAxAAAAGOSelQB//EABUQAQEAAAAAAAAAAAAAAAAAABBB/9oACAEBAAEFAof/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAYEAADAQEAAAAAAAAAAAAAAAAAAREhQf/aAAgBAQABPyFDbRJTh//aAAwDAQACAAMAAAAQc/8A/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8QJ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQEBAQEBAAAAAAAAAAAAAAERAEEhMf/aAAgBAQABPxCkFStuGgt+p2byEE4c3//Z"},"images":{"fallback":{"src":"/static/4400c8745fd3d2ab6d1cd9b3f45d0440/c62f0/network-1.jpg","srcSet":"/static/4400c8745fd3d2ab6d1cd9b3f45d0440/86eb0/network-1.jpg 300w,\n/static/4400c8745fd3d2ab6d1cd9b3f45d0440/a06fe/network-1.jpg 600w,\n/static/4400c8745fd3d2ab6d1cd9b3f45d0440/c62f0/network-1.jpg 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/4400c8745fd3d2ab6d1cd9b3f45d0440/cf267/network-1.webp 300w,\n/static/4400c8745fd3d2ab6d1cd9b3f45d0440/540ab/network-1.webp 600w,\n/static/4400c8745fd3d2ab6d1cd9b3f45d0440/3d0d9/network-1.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":500}}}},"html":"<p>Estou planejando alguns artigos com aplicação de redes neurais, antes melhor explicar os conceitos básicos e suas aplicações, para isso, vamos criar nossa rede neural</p>\n<h2>Conceitos</h2>\n<p>Primeiro os conceito do modelo de neurônio que vamos utilizar, e como ele se organiza em estrutura para formar uma rede</p>\n<h3>Modelo Perceptron</h3>\n<p>Modelo matemático que recebe valores, multiplicados pelos pesos correspondentes, com os resultados somados e ajustados na saída para 1 ou 0, representado na imagem a seguir:</p>\n<p class=\"center bold\">A estrutura de um neurônio artificial do tipo&nbsp;<em>Perceptron</em>&nbsp;(ou neurônio McCulloch-Pitts)</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 451px; '>\n      <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHaasESD//EABsQAAEEAwAAAAAAAAAAAAAAAAEAAhEiEBIh/9oACAEBAAEFAtutdWQosABj/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFRABAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQEABj8CY//EABoQAQACAwEAAAAAAAAAAAAAAAEAERAhQdH/2gAIAQEAAT8ht4goYN2UVxBKDWP/2gAMAwEAAgADAAAAEKPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAQEAAwEBAAAAAAAAAAAAAREAIVGRQWH/2gAIAQEAAT8Q5CVO35mnQSlI+YSnrEBgLD7oJHQAMAHHG//Z'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source data-srcset='/static/b7c76ac67849a0eda8df7dc8df9e1957/cbea2/simulator_perceptron.webp 240w,\n/static/b7c76ac67849a0eda8df7dc8df9e1957/60574/simulator_perceptron.webp 451w' sizes='(max-width: 451px) 100vw, 451px' type='image/webp'>\n          <source srcset='/static/b7c76ac67849a0eda8df7dc8df9e1957/46946/simulator_perceptron.jpg 240w,\n/static/b7c76ac67849a0eda8df7dc8df9e1957/43199/simulator_perceptron.jpg 451w' sizes='(max-width: 451px) 100vw, 451px' type='image/jpeg'>\n          <img class='gatsby-resp-image-image lazyload' data-src='/static/b7c76ac67849a0eda8df7dc8df9e1957/43199/simulator_perceptron.jpg' alt='Uma esfera grande com símbolo de sigma, esferas à esquerda e setas ligando a grande da esquerda para direita e uma seta para direita ligando a outra esfera' title='Algoritmo Perceptron' loading='lazy' decoding='async' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;'>\n        </picture>\n    </span></p>\n<p class=\"center\">Fonte: adaptado de Silva et al. (2016)<p>\n<p>A figura ilustra uma simulação de funcionamento de um neurônio no modelo <em>Perceptron</em> com valores de entrada <strong>{x<sub>0</sub>, x<sub>1</sub>, x<sub>2</sub> ... x<sub>d</sub>}</strong> sendo multiplicados por pesos sinápticos <strong>{w<sub>01</sub>, w<sub>02</sub>, w<sub>03</sub> ... w<sub>0d</sub>}</strong>, respectivamente</p>\n<p>Esses valores são somados e acrescidos por um valor externo <strong>b<sub>0</sub></strong>, também um peso, gerando o somatório <strong>v<sub>0</sub></strong>, aplicado na função <strong>f(.)</strong> para gerar o valor de saída <strong>y<sub>0</sub></strong></p>\n<p>Sendo <strong>x<sub>0</sub>, x<sub>1</sub>, x<sub>2</sub> ... x<sub>d</sub></strong>, <strong>w<sub>01</sub>, w<sub>02</sub>, w<sub>03</sub> ... w<sub>0d</sub></strong>, <strong>b<sub>0</sub></strong> e <strong>v<sub>0</sub></strong> valores entre 0 e 1, e <strong>y<sub>0</sub></strong> com valor de 0 ou 1</p>\n<p>A função <strong>f(.)</strong> é determinada por um valor limiar, dependendo da aplicação, retornando 0 ou 1</p>\n<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" class=\"center\" width=\"350\" height=\"100\" viewBox=\"0 0 280 80\">\n    <g fill=\"var(--texts)\" font-size=\"1rem\" font-weight=\"700\">\n        <text x=\"0\" y=\"44\"><tspan>y<tspan font-size=\"0.5rem\">0</tspan></tspan></text>\n        <text x=\"25\" y=\"60\" font-size=\"64px\"><tspan font-weight=\"300\">{</tspan></text>\n        <text x=\"52\" y=\"35\">\n            <tspan>0</tspan> <tspan font-weight=\"300\">se</tspan> <tspan>v<tspan font-size=\"0.5rem\">0</tspan></tspan> <tspan font-weight=\"300\">menor ou igual que</tspan> <tspan>liminar</tspan>\n        </text>\n        <text x=\"52\" y=\"60\">\n            <tspan>1<tspan> <tspan font-weight=\"300\">se</tspan> <tspan>v</tspan><tspan font-size=\"0.5rem\">0</tspan> <tspan font-weight=\"300\">maior que</tspan> </tspan>liminar</tspan>\n        </text>\n    </g>\n</svg>\n<h3>Multicamadas</h3>\n<p>Com aplicação do modelo de neurônio em sequência, com os valores <strong>v<sub>0</sub></strong> (somatória) sendo usando para a valor de entrada para outros neurônios</p>\n<p class=\"center bold\">Rede neural com multicamadas de neurônios</p>\n<svg version=\"1.0\" xmlns=\"http://www.w3.org/2000/svg\" class=\"center\" width=\"330\" height=\"419\" viewBox=\"0 0 330 419\">\n <defs>\n  <marker id=\"TriangleOutS\" overflow=\"visible\" orient=\"auto\">\n   <path transform=\"scale(.2)\" d=\"m5.77 0-8.65 5v-10z\" fill-rule=\"evenodd\" stroke=\"var(--texts)\" fill=\"var(--texts)\" stroke-width=\"1pt\"/>\n  </marker>\n </defs>\n <g transform=\"translate(-212.14 -322.45)\">\n    <g transform=\"translate(197.51 334.13)\">\n        <path transform=\"translate(177.88 90.628)\" d=\"m143.96 136.45c5e-3 15.872-12.86 28.742-28.733 28.742-15.872 0-28.738-12.87-28.733-28.742-0.0051-15.872 12.86-28.742 28.733-28.742 15.872 0 28.738 12.87 28.733 28.742z\" fill=\"#ab10d2\"/>\n        <g fill=\"none\" marker-end=\"url(#TriangleOutS)\" stroke=\"var(--texts)\">\n            <path d=\"m190.28 343.53 85.306-94.784\" stroke-width=\"8\"/>\n            <path d=\"m180.8 185.84 85.306 31.882\" stroke-width=\"10\"/>\n            <path d=\"m187.69 265.98 80.998-30.159\" stroke-width=\"5\"/>\n            <path d=\"m185.11 103.98 90.476 100.82\" stroke-width=\"5\"/>\n        </g>\n        <path transform=\"translate(64.551 218.28)\" d=\"m143.96 136.45c5e-3 15.872-12.86 28.742-28.733 28.742-15.872 0-28.738-12.87-28.733-28.742-0.0051-15.872 12.86-28.742 28.733-28.742 15.872 0 28.738 12.87 28.733 28.742z\" fill=\"#047391\"/>\n        <path transform=\"translate(64.551 48.485)\" d=\"m143.96 136.45c5e-3 15.872-12.86 28.742-28.733 28.742-15.872 0-28.738-12.87-28.733-28.742-0.0051-15.872 12.86-28.742 28.733-28.742 15.872 0 28.738 12.87 28.733 28.742z\" fill=\"#047391\"/>\n        <path transform=\"translate(64.551 133.38)\" d=\"m143.96 136.45c5e-3 15.872-12.86 28.742-28.733 28.742-15.872 0-28.738-12.87-28.733-28.742-0.0051-15.872 12.86-28.742 28.733-28.742 15.872 0 28.738 12.87 28.733 28.742z\" fill=\"#047391\"/>\n        <path transform=\"translate(64.551 -36.41)\" d=\"m143.96 136.45c5e-3 15.872-12.86 28.742-28.733 28.742-15.872 0-28.738-12.87-28.733-28.742-0.0051-15.872 12.86-28.742 28.733-28.742 15.872 0 28.738 12.87 28.733 28.742z\" fill=\"#047391\"/>\n        <g fill=\"none\" marker-end=\"url(#TriangleOutS)\" stroke=\"var(--texts)\">\n            <path d=\"m70.503 297.86 87.891-93.923\" stroke-width=\"5\"/>\n            <path d=\"m71.364 300.44 79.274-23.265\" stroke-width=\"8\"/>\n            <path d=\"m73.088 163.44 85.306 83.583\" stroke-width=\"8\"/>\n            <path d=\"m69.641 154.82 84.444-45.669\" stroke-width=\"10\"/>\n            <path d=\"m71.364 157.41 81.859 21.542\" stroke-width=\"10\"/>\n            <path d=\"m69.641 299.58 84.444 43.945\" stroke-width=\"10\"/>\n        </g>\n        <path transform=\"translate(-49.083 162.22)\" d=\"m143.96 136.45c5e-3 15.872-12.86 28.742-28.733 28.742-15.872 0-28.738-12.87-28.733-28.742-0.0051-15.872 12.86-28.742 28.733-28.742 15.872 0 28.738 12.87 28.733 28.742z\" fill=\"#00a33d\"/>   \n        <path transform=\"translate(-49.083 19.95)\" d=\"m143.96 136.45c5e-3 15.872-12.86 28.742-28.733 28.742-15.872 0-28.738-12.87-28.733-28.742-0.0051-15.872 12.86-28.742 28.733-28.742 15.872 0 28.738 12.87 28.733 28.742z\" fill=\"#00a33d\"/>\n    </g>\n    <g fill=\"var(--texts)\" font-family=\"Calibri\" font-size=\"24px\" stroke-linecap=\"square\" stroke-linejoin=\"round\" stroke-width=\"4\" text-anchor=\"middle\">\n        <text x=\"270\" y=\"365\" text-align=\"center\" style=\"line-height:0%\"><tspan style=\"line-height:1.25\"><tspan>camada</tspan></tspan><tspan x=\"270\" y=\"395\" style=\"line-height:1.25\"><tspan>de entrada</tspan></tspan></text>\n        <text x=\"375\" y=\"365\" text-align=\"center\" style=\"line-height:0%\"><tspan style=\"line-height:1.25\"><tspan>camada</tspan></tspan><tspan x=\"375\" y=\"395\" style=\"line-height:1.25\"><tspan>oculta</tspan></tspan></text>\n        <text x=\"490\" y=\"365\" text-align=\"center\" style=\"line-height:0%\"><tspan style=\"line-height:1.25\"><tspan>camada</tspan></tspan><tspan x=\"490\" y=\"395\" style=\"line-height:1.25\"><tspan>de saída</tspan></tspan></text>\n    </g>\n </g>\n</svg>\n<p class=\"center\">Fonte: adaptado de Wikipédia<p>\n<p>Cada camada tem uma identificação:</p>\n<ul>\n<li><strong>camada de entrada</strong> (<em>input layer</em>): Valores iniciais, vindo pela entrada de dados, pode ser coordenadas, estrutura de uma imagem entre outros;</li>\n<li><strong>camada oculta</strong> (<em>hidden layer</em>): As camadas com os neurônios que não são os de entrada e saída;</li>\n<li><strong>camada de saída</strong> (<em>output layer</em>): Saída de valores, que podem ter um ou mais saídas todas sendo 0 ou 1.</li>\n</ul>\n<h2>Implementação</h2>\n<p>Agora com os conceitos em mão vamos para aplicação, com somente uma camada oculta</p>\n<h3>Matemática</h3>\n<p>No exemplo vamos usar uma rede com três (3) neurônios na camada de entrada, cinco (5) na camada oculta e somente dois (2) na camada de saída</p>\n<p>Na <strong>camada de entrada</strong> (<em>layer_input</em>) como parâmetro criamos uma matriz com a quantidade de entradas (3) contendo os valores desejados, exemplo:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">A <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Como <strong>pesos da camada de entrada</strong> (<em>weight_input</em>) devemos ter uma matriz com a quantidade de entradas (3) e quantidade de ocultas (5), exemplo:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">B <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">[</span><span class=\"token number\">0.11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span><span class=\"token number\">0.21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.25</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span><span class=\"token number\">0.31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.33</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.34</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.35</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Para calcular a saída <strong>pesos da camada oculta</strong> (<em>weight_hidden</em>) precisamos de uma matriz com dimensões de com quantidade de ocultas (5) e quantidade de saída (2), exemplo:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">C <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">[</span><span class=\"token number\">0.11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span><span class=\"token number\">0.21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.22</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span><span class=\"token number\">0.31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.32</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span><span class=\"token number\">0.41</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.42</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span><span class=\"token number\">0.51</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.52</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Para calcular a primeira passagem, da camada de entrada para camada oculta, podemos calcular com <strong>multiplicação de matrizes</strong> dos valores e pesos de entrada</p>\n<blockquote>\n<p>Lembrando do índice na maioria das linguagens de programação começa com 0, ou seja <strong>A[0][1]</strong> é igual a <strong>a<sub>1, 2<sub></strong></p>\n</blockquote>\n<p>Aplicando a multiplicação entre <code class=\"language-text\">A</code> e <code class=\"language-text\">B</code> temos:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">X <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    A<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">+</span>  A<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">+</span>  A<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    A<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">+</span>  A<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">+</span>  A<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    A<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">+</span>  A<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">+</span>  A<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    A<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">+</span>  A<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">+</span>  A<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    A<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">+</span>  A<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">+</span>  A<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> B<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Para aplicar essa fórmula, vamos usar o pacote do Python chamada NumPy, temos um artigo para explicar a <a href=\"/ambiente-python/\">instalação de pacotes no Python</a></p>\n<p>A função <code class=\"language-text\">dot</code> realiza um produto de duas matrizes, fazendo uso dela temos</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\nX <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> B<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Assim temos o resultado <code class=\"language-text\">[0.146, 0.152, 0.158, 0.164, 0.17]</code> na variável X com os valores para camada oculta</p>\n<p>Para apurar os resultados finais temos os valores em <code class=\"language-text\">X</code> que multiplicamos com os pesos em <code class=\"language-text\">C</code>, com seguinte código</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> C<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Assim temos <code class=\"language-text\">[0.2509, 0.2588]</code> que dependendo do nosso valor de limiar para cada saída, pode resultar cada um como 0 ou 1</p>\n<h3>Finalmente</h3>\n<p>Aplicando a função de classificação com os valores limiares</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">classifier <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> idx<span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token keyword\">if</span> item <span class=\"token operator\">&lt;=</span> thresholds<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span> <span class=\"token keyword\">else</span> <span class=\"token number\">1</span></code></pre></div>\n<p>Organizando o que temos</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">neural_network</span><span class=\"token punctuation\">(</span>layer_input<span class=\"token punctuation\">,</span> weight_input<span class=\"token punctuation\">,</span> weight_hidden<span class=\"token punctuation\">,</span> thresholds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    layer_hidden <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>layer_input<span class=\"token punctuation\">,</span> weight_input<span class=\"token punctuation\">)</span>\n    layer_output <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>layer_hidden<span class=\"token punctuation\">,</span> weight_hidden<span class=\"token punctuation\">)</span>\n\n    enumerated <span class=\"token operator\">=</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>layer_output<span class=\"token punctuation\">)</span>\n    classifier <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> idx<span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token keyword\">if</span> item <span class=\"token operator\">&lt;=</span> thresholds<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span> <span class=\"token keyword\">else</span> <span class=\"token number\">1</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>classifier<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> e <span class=\"token keyword\">in</span> enumerated<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Só isso? É... só isso!</p>\n<h2>Referências</h2>\n<p><a href=\"https://twitter.com/svpino/status/1582703127651721217\">Tweet from Santiago</a></p>\n<p><a href=\"https://www.deeplearningbook.com.br/o-perceptron-parte-1/\">Deep Learning Book - O Perceptron</a></p>\n<p><a href=\"https://www.youtube.com/watch?v=aircAruvnKk&#x26;t=2s&#x26;ab_channel=3Blue1Brown\">But what is a neural network? | Chapter 1, Deep learning</a></p>\n<p><a href=\"https://numpy.org/doc/stable/reference/generated/numpy.dot.html\">NumPy - numpy.dot</a></p>","timeToRead":3,"excerpt":"Estou planejando alguns artigos com aplicação de redes neurais, antes melhor explicar os conceitos básicos e suas aplicações, para isso…"}},"pageContext":{"slug":"/construindo-uma-rede-neural/","recommendedLast":{"frontmatter":{"date":"23 de julho de 2023","title":"Animação para esqueleto de elementos","category":"CSS","description":"Usando HTML, CSS e keyframes para animação de esqueleto de elementos carregando com gradiente","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBP/EABYBAQEBAAAAAAAAAAAAAAAAAAECBP/aAAwDAQACEAMQAAABzSNNUhf/xAAXEAADAQAAAAAAAAAAAAAAAAABAiEy/9oACAEBAAEFAoEhd9f/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAARARQf/aAAgBAQAGPwK9E4//xAAZEAACAwEAAAAAAAAAAAAAAAAAAREhMVH/2gAIAQEAAT8hqw0N8FBZj//aAAwDAQACAAMAAAAQf+//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQIBAT8QxH//xAAbEAEAAwEAAwAAAAAAAAAAAAABESFBADFhgf/aAAgBAQABPxAAUttKr5ykW1HIJTkPIifJvvv/2Q=="},"images":{"fallback":{"src":"/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/c62f0/skeleton-1.jpg","srcSet":"/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/86eb0/skeleton-1.jpg 300w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/a06fe/skeleton-1.jpg 600w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/c62f0/skeleton-1.jpg 1200w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/23bd6/skeleton-1.jpg 2400w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/cf267/skeleton-1.webp 300w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/540ab/skeleton-1.webp 600w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/3d0d9/skeleton-1.webp 1200w,\n/static/40aaa21d6d234b122ff0bd3b4ca0f9a0/51c0c/skeleton-1.webp 2400w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":500}}},"published":true},"timeToRead":1,"fields":{"slug":"/estilizacao-skeleton/"}},"recommendedCategory":{"frontmatter":{"date":"26 de janeiro de 2022","title":"Como trapacear Term.ooo, ou ter um conselheiro","category":"Python","description":"Análise de uma partida do Term.ooo com Python e Pandas para recomendar melhores possibilidades","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABa0lEQVR42mWQS0/CQBSF+RH+AwVa+pjpu5221hZEoRANaEIpRFpaIhg1EXlo1I0xbk3cuHDnwr/pLVGiMTk9uT2Tb87N5K6DeNqJbk9O7wbjRZgse+lNfzQP4ufz+efr+8fL2+P4at4dQgin99Hk6Wy26KWAAJiDb9YdTlrBoN6K/PZag3o7boCOIr/1oyyH8OK4D0gGwx2LMPVNly8yMoNEmpNK/EqcRHPwCyHM8iqRGR4VmW61ueyNAMxNgxj2aVqeo5Jd03EUo0y2dzTiGRa4q5sV0wH3iF0mtqtbcMVvGJqThuXZkubplsJilcUKg1QuGzLnsMIikMYLkOBiKczg9Lt5GSa+7W08XGqHBxVGcDTT1SwiKNwWhQo0ytPgfJ7ChZJIsajwF86a7TJV35Nr+0ytprKiJakEy1ClQDM4i2HWeYFg6f/aKaxtbtKKaetJp2qoKi8ZWILyjMGSjkQiKkSQTVGF91vDX0ApiXPYAWF6AAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/cb30862b295b9848efe1b9fcb06bbcf7/35f42/termooo_slice-1.png","srcSet":"/static/cb30862b295b9848efe1b9fcb06bbcf7/c79a3/termooo_slice-1.png 240w,\n/static/cb30862b295b9848efe1b9fcb06bbcf7/f7e0e/termooo_slice-1.png 480w,\n/static/cb30862b295b9848efe1b9fcb06bbcf7/35f42/termooo_slice-1.png 960w","sizes":"(min-width: 960px) 960px, 100vw"},"sources":[{"srcSet":"/static/cb30862b295b9848efe1b9fcb06bbcf7/8aa0c/termooo_slice-1.webp 240w,\n/static/cb30862b295b9848efe1b9fcb06bbcf7/5ad5f/termooo_slice-1.webp 480w,\n/static/cb30862b295b9848efe1b9fcb06bbcf7/b9ace/termooo_slice-1.webp 960w","type":"image/webp","sizes":"(min-width: 960px) 960px, 100vw"}]},"width":1200,"height":500}}},"published":true},"timeToRead":8,"fields":{"slug":"/partida-term.ooo/"}}}},"staticQueryHashes":["1433154849","3590877595","3764592887","512065377","764694655"],"slicesMap":{}}